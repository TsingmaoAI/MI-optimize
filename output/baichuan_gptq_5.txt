INFO:root:--model: /models/Baichuan2-7B-Base
INFO:root:--algo: gptq
INFO:root:--wbit: 2
INFO:root:--device: cuda
INFO:root:Current Time: 2024-08-23 16:34:14.647926
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'BaichuanTokenizer'. 
The class this function is called from is 'LlamaTokenizer'.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/home/psh/miniconda3/envs/psh_python/lib/python3.9/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards:  50%|█████     | 1/2 [00:26<00:26, 26.21s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:00<00:00, 30.91s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:00<00:00, 30.20s/it]
INFO:root:get_c4_validation
Token indices sequence length is longer than the specified maximum sequence length for this model (557878 > 4096). Running this sequence through the model will result in indexing errors
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:08<00:33,  8.29s/it] 40%|████      | 2/5 [00:11<00:15,  5.31s/it] 60%|██████    | 3/5 [00:14<00:08,  4.36s/it] 80%|████████  | 4/5 [00:23<00:06,  6.02s/it]100%|██████████| 5/5 [00:26<00:00,  4.98s/it]100%|██████████| 5/5 [00:26<00:00,  5.29s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.18s/it] 40%|████      | 2/5 [00:06<00:09,  3.15s/it] 60%|██████    | 3/5 [00:09<00:06,  3.17s/it] 80%|████████  | 4/5 [00:17<00:05,  5.09s/it]100%|██████████| 5/5 [00:20<00:00,  4.43s/it]100%|██████████| 5/5 [00:20<00:00,  4.16s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.37s/it] 40%|████      | 2/5 [00:06<00:09,  3.06s/it] 60%|██████    | 3/5 [00:09<00:06,  3.13s/it] 80%|████████  | 4/5 [00:17<00:05,  5.07s/it]100%|██████████| 5/5 [00:20<00:00,  4.47s/it]100%|██████████| 5/5 [00:20<00:00,  4.17s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.45s/it] 40%|████      | 2/5 [00:06<00:09,  3.13s/it] 60%|██████    | 3/5 [00:09<00:06,  3.17s/it] 80%|████████  | 4/5 [00:17<00:05,  5.06s/it]100%|██████████| 5/5 [00:20<00:00,  4.30s/it]100%|██████████| 5/5 [00:20<00:00,  4.10s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.22s/it] 40%|████      | 2/5 [00:06<00:08,  3.00s/it] 60%|██████    | 3/5 [00:09<00:06,  3.13s/it] 80%|████████  | 4/5 [00:17<00:05,  5.10s/it]100%|██████████| 5/5 [00:20<00:00,  4.41s/it]100%|██████████| 5/5 [00:20<00:00,  4.13s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.32s/it] 40%|████      | 2/5 [00:06<00:08,  2.98s/it] 60%|██████    | 3/5 [00:09<00:06,  3.06s/it] 80%|████████  | 4/5 [00:17<00:04,  4.97s/it]100%|██████████| 5/5 [00:20<00:00,  4.32s/it]100%|██████████| 5/5 [00:20<00:00,  4.06s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.27s/it] 40%|████      | 2/5 [00:06<00:09,  3.13s/it] 60%|██████    | 3/5 [00:09<00:06,  3.16s/it] 80%|████████  | 4/5 [00:17<00:05,  5.02s/it]100%|██████████| 5/5 [00:20<00:00,  4.34s/it]100%|██████████| 5/5 [00:20<00:00,  4.10s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.32s/it] 40%|████      | 2/5 [00:06<00:09,  3.04s/it] 60%|██████    | 3/5 [00:09<00:06,  3.19s/it] 80%|████████  | 4/5 [00:17<00:05,  5.06s/it]100%|██████████| 5/5 [00:20<00:00,  4.37s/it]100%|██████████| 5/5 [00:20<00:00,  4.12s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:14,  3.52s/it] 40%|████      | 2/5 [00:06<00:09,  3.12s/it] 60%|██████    | 3/5 [00:09<00:06,  3.16s/it] 80%|████████  | 4/5 [00:17<00:05,  5.20s/it]100%|██████████| 5/5 [00:21<00:00,  4.47s/it]100%|██████████| 5/5 [00:21<00:00,  4.21s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:02<00:11,  2.91s/it] 40%|████      | 2/5 [00:05<00:08,  2.93s/it] 60%|██████    | 3/5 [00:08<00:06,  3.01s/it] 80%|████████  | 4/5 [00:16<00:04,  4.96s/it]100%|██████████| 5/5 [00:20<00:00,  4.32s/it]100%|██████████| 5/5 [00:20<00:00,  4.02s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.22s/it] 40%|████      | 2/5 [00:06<00:09,  3.04s/it] 60%|██████    | 3/5 [00:09<00:06,  3.15s/it] 80%|████████  | 4/5 [00:17<00:05,  5.04s/it]100%|██████████| 5/5 [00:20<00:00,  4.37s/it]100%|██████████| 5/5 [00:20<00:00,  4.11s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.29s/it] 40%|████      | 2/5 [00:06<00:09,  3.03s/it] 60%|██████    | 3/5 [00:09<00:06,  3.09s/it] 80%|████████  | 4/5 [00:17<00:05,  5.03s/it]100%|██████████| 5/5 [00:20<00:00,  4.36s/it]100%|██████████| 5/5 [00:20<00:00,  4.10s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.26s/it] 40%|████      | 2/5 [00:06<00:09,  3.11s/it] 60%|██████    | 3/5 [00:09<00:06,  3.25s/it] 80%|████████  | 4/5 [00:18<00:05,  5.26s/it]100%|██████████| 5/5 [00:21<00:00,  4.55s/it]100%|██████████| 5/5 [00:21<00:00,  4.26s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.31s/it] 40%|████      | 2/5 [00:06<00:09,  3.08s/it] 60%|██████    | 3/5 [00:09<00:06,  3.11s/it] 80%|████████  | 4/5 [00:17<00:04,  4.98s/it]100%|██████████| 5/5 [00:20<00:00,  4.32s/it]100%|██████████| 5/5 [00:20<00:00,  4.08s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.23s/it] 40%|████      | 2/5 [00:06<00:08,  2.98s/it] 60%|██████    | 3/5 [00:09<00:06,  3.07s/it] 80%|████████  | 4/5 [00:17<00:05,  5.02s/it]100%|██████████| 5/5 [00:20<00:00,  4.38s/it]100%|██████████| 5/5 [00:20<00:00,  4.09s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.30s/it] 40%|████      | 2/5 [00:06<00:09,  3.02s/it] 60%|██████    | 3/5 [00:09<00:06,  3.14s/it] 80%|████████  | 4/5 [00:17<00:05,  5.10s/it]100%|██████████| 5/5 [00:20<00:00,  4.44s/it]100%|██████████| 5/5 [00:20<00:00,  4.16s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:14,  3.71s/it] 40%|████      | 2/5 [00:06<00:09,  3.20s/it] 60%|██████    | 3/5 [00:09<00:06,  3.20s/it] 80%|████████  | 4/5 [00:17<00:05,  5.05s/it]100%|██████████| 5/5 [00:20<00:00,  4.40s/it]100%|██████████| 5/5 [00:20<00:00,  4.18s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:02<00:11,  2.97s/it] 40%|████      | 2/5 [00:05<00:08,  2.75s/it] 60%|██████    | 3/5 [00:08<00:05,  2.96s/it] 80%|████████  | 4/5 [00:16<00:05,  5.01s/it]100%|██████████| 5/5 [00:20<00:00,  4.40s/it]100%|██████████| 5/5 [00:20<00:00,  4.05s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:02<00:10,  2.73s/it] 40%|████      | 2/5 [00:05<00:08,  2.79s/it] 60%|██████    | 3/5 [00:08<00:05,  2.99s/it] 80%|████████  | 4/5 [00:16<00:04,  4.91s/it]100%|██████████| 5/5 [00:19<00:00,  4.27s/it]100%|██████████| 5/5 [00:19<00:00,  3.96s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.20s/it] 40%|████      | 2/5 [00:06<00:08,  2.97s/it] 60%|██████    | 3/5 [00:09<00:06,  3.05s/it] 80%|████████  | 4/5 [00:16<00:04,  4.94s/it]100%|██████████| 5/5 [00:20<00:00,  4.29s/it]100%|██████████| 5/5 [00:20<00:00,  4.03s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.35s/it] 40%|████      | 2/5 [00:05<00:08,  2.92s/it] 60%|██████    | 3/5 [00:09<00:06,  3.07s/it] 80%|████████  | 4/5 [00:16<00:04,  4.93s/it]100%|██████████| 5/5 [00:20<00:00,  4.35s/it]100%|██████████| 5/5 [00:20<00:00,  4.07s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.10s/it] 40%|████      | 2/5 [00:05<00:08,  2.76s/it] 60%|██████    | 3/5 [00:08<00:05,  2.95s/it] 80%|████████  | 4/5 [00:16<00:04,  4.90s/it]100%|██████████| 5/5 [00:19<00:00,  4.26s/it]100%|██████████| 5/5 [00:19<00:00,  3.96s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.20s/it] 40%|████      | 2/5 [00:06<00:08,  3.00s/it] 60%|██████    | 3/5 [00:09<00:06,  3.08s/it] 80%|████████  | 4/5 [00:17<00:04,  4.97s/it]100%|██████████| 5/5 [00:20<00:00,  4.32s/it]100%|██████████| 5/5 [00:20<00:00,  4.06s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.43s/it] 40%|████      | 2/5 [00:06<00:09,  3.25s/it] 60%|██████    | 3/5 [00:09<00:06,  3.25s/it] 80%|████████  | 4/5 [00:17<00:05,  5.11s/it]100%|██████████| 5/5 [00:20<00:00,  4.43s/it]100%|██████████| 5/5 [00:20<00:00,  4.20s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:14,  3.64s/it] 40%|████      | 2/5 [00:06<00:09,  3.20s/it] 60%|██████    | 3/5 [00:09<00:06,  3.25s/it] 80%|████████  | 4/5 [00:18<00:05,  5.35s/it]100%|██████████| 5/5 [00:21<00:00,  4.64s/it]100%|██████████| 5/5 [00:21<00:00,  4.36s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.39s/it] 40%|████      | 2/5 [00:06<00:09,  3.08s/it] 60%|██████    | 3/5 [00:09<00:06,  3.12s/it] 80%|████████  | 4/5 [00:17<00:04,  4.99s/it]100%|██████████| 5/5 [00:20<00:00,  4.36s/it]100%|██████████| 5/5 [00:20<00:00,  4.10s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.36s/it] 40%|████      | 2/5 [00:06<00:09,  3.19s/it] 60%|██████    | 3/5 [00:09<00:06,  3.27s/it] 80%|████████  | 4/5 [00:17<00:05,  5.15s/it]100%|██████████| 5/5 [00:20<00:00,  4.33s/it]100%|██████████| 5/5 [00:20<00:00,  4.14s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:13,  3.27s/it] 40%|████      | 2/5 [00:06<00:09,  3.01s/it] 60%|██████    | 3/5 [00:09<00:06,  3.07s/it] 80%|████████  | 4/5 [00:17<00:05,  5.00s/it]100%|██████████| 5/5 [00:20<00:00,  4.34s/it]100%|██████████| 5/5 [00:20<00:00,  4.07s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.24s/it] 40%|████      | 2/5 [00:06<00:09,  3.17s/it] 60%|██████    | 3/5 [00:09<00:06,  3.22s/it] 80%|████████  | 4/5 [00:17<00:05,  5.08s/it]100%|██████████| 5/5 [00:20<00:00,  4.40s/it]100%|██████████| 5/5 [00:20<00:00,  4.16s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.15s/it] 40%|████      | 2/5 [00:06<00:09,  3.03s/it] 60%|██████    | 3/5 [00:09<00:06,  3.09s/it] 80%|████████  | 4/5 [00:17<00:05,  5.32s/it]100%|██████████| 5/5 [00:21<00:00,  4.56s/it]100%|██████████| 5/5 [00:21<00:00,  4.24s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.25s/it] 40%|████      | 2/5 [00:05<00:08,  2.95s/it] 60%|██████    | 3/5 [00:09<00:06,  3.15s/it] 80%|████████  | 4/5 [00:17<00:04,  4.93s/it]100%|██████████| 5/5 [00:20<00:00,  4.38s/it]100%|██████████| 5/5 [00:20<00:00,  4.09s/it]
  0%|          | 0/5 [00:00<?, ?it/s] 20%|██        | 1/5 [00:03<00:12,  3.16s/it] 40%|████      | 2/5 [00:06<00:09,  3.07s/it] 60%|██████    | 3/5 [00:09<00:06,  3.20s/it] 80%|████████  | 4/5 [00:17<00:05,  5.17s/it]100%|██████████| 5/5 [00:21<00:00,  4.56s/it]100%|██████████| 5/5 [00:21<00:00,  4.24s/it]
INFO:root:Quantize Time 4469.942821979523
  0%|          | 0/52 [00:00<?, ?it/s]